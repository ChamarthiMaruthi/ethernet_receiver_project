/*
 ethernet_top.v
 Top-level module that instantiates frame_detector, data_capture, fifo, crc_stub
*/
module ethernet_top(
    input clk,
    input rst,
    input [7:0] rx_byte,
    input rx_byte_valid,
    output fifo_full,
    output fifo_empty,
    output [7:0] fifo_data_out,
    input fifo_rd_en,
    output crc_ok_led
);
    wire frame_valid;
    wire capturing;
    wire fifo_wr_en;
    wire [7:0] fifo_wr_data;
    wire frame_complete;
    wire [31:0] last_four;

    frame_detector u_frame_detector (
        .clk(clk),
        .rst(rst),
        .rx_byte(rx_byte),
        .rx_byte_valid(rx_byte_valid),
        .frame_valid(frame_valid),
        .capturing(capturing)
    );

    data_capture u_data_capture (
        .clk(clk),
        .rst(rst),
        .rx_byte(rx_byte),
        .rx_byte_valid(rx_byte_valid),
        .capturing(capturing),
        .fifo_wr_en(fifo_wr_en),
        .fifo_wr_data(fifo_wr_data),
        .frame_complete(frame_complete),
        .captured_crc_input(last_four)
    );

    fifo_buffer #(.DATA_WIDTH(8), .ADDR_WIDTH(8)) u_fifo (
        .clk(clk),
        .rst(rst),
        .wr_en(fifo_wr_en),
        .rd_en(fifo_rd_en),
        .data_in(fifo_wr_data),
        .data_out(fifo_data_out),
        .full(fifo_full),
        .empty(fifo_empty)
    );

    crc_stub u_crc (
        .clk(clk),
        .rst(rst),
        .last_four_bytes(last_four),
        .crc_ok(crc_ok_led)
    );
endmodule
